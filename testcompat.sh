#!/bin/bash
set -Ceuo pipefail

test -f sample.gsm || bash prepsample.sh
test ! -f z.log || rm -f z.log

./gribslim -f'p[VVPa]=v70000=v30000=|&,p[rDIV]=v85000=v25000=|&,p[rVOR]=v50000=&,p[U]=p[V]=p[T]=p[RH]=p[Z]=||||,|||,g361<&,p[Z]=v50000=&p[RAIN]=p[Pmsl]=||,g720%0=g360=|&,|' -o/dev/null sample.gsm > z.log

diff -- z.log - <<EOF
b20221220T1200Z      U f+0    d+0    v101214.5
b20221220T1200Z      V f+0    d+0    v101214.5
b20221220T1200Z      T f+0    d+0    v101302.5
b20221220T1200Z     RH f+0    d+0    v101302.5
b20221220T1200Z   Pmsl f+0    d+0    v101324.0
b20221220T1200Z      U f+0    d+0    v100000.0
b20221220T1200Z      V f+0    d+0    v100000.0
b20221220T1200Z      T f+0    d+0    v100000.0
b20221220T1200Z     RH f+0    d+0    v100000.0
b20221220T1200Z      Z f+0    d+0    v100000.0
b20221220T1200Z      U f+0    d+0    v92500.0 
b20221220T1200Z      V f+0    d+0    v92500.0 
b20221220T1200Z      T f+0    d+0    v92500.0 
b20221220T1200Z     RH f+0    d+0    v92500.0 
b20221220T1200Z      Z f+0    d+0    v92500.0 
b20221220T1200Z      U f+0    d+0    v85000.0 
b20221220T1200Z      V f+0    d+0    v85000.0 
b20221220T1200Z      T f+0    d+0    v85000.0 
b20221220T1200Z     RH f+0    d+0    v85000.0 
b20221220T1200Z      Z f+0    d+0    v85000.0 
b20221220T1200Z      U f+0    d+0    v70000.0 
b20221220T1200Z      V f+0    d+0    v70000.0 
b20221220T1200Z      T f+0    d+0    v70000.0 
b20221220T1200Z     RH f+0    d+0    v70000.0 
b20221220T1200Z      Z f+0    d+0    v70000.0 
b20221220T1200Z   VVPa f+0    d+0    v70000.0 
b20221220T1200Z      U f+0    d+0    v60000.0 
b20221220T1200Z      V f+0    d+0    v60000.0 
b20221220T1200Z      T f+0    d+0    v60000.0 
b20221220T1200Z     RH f+0    d+0    v60000.0 
b20221220T1200Z      Z f+0    d+0    v60000.0 
b20221220T1200Z      U f+0    d+0    v50000.0 
b20221220T1200Z      V f+0    d+0    v50000.0 
b20221220T1200Z      T f+0    d+0    v50000.0 
b20221220T1200Z     RH f+0    d+0    v50000.0 
b20221220T1200Z      Z f+0    d+0    v50000.0 
b20221220T1200Z   rVOR f+0    d+0    v50000.0 
b20221220T1200Z      U f+0    d+0    v40000.0 
b20221220T1200Z      V f+0    d+0    v40000.0 
b20221220T1200Z      T f+0    d+0    v40000.0 
b20221220T1200Z     RH f+0    d+0    v40000.0 
b20221220T1200Z      Z f+0    d+0    v40000.0 
b20221220T1200Z      U f+0    d+0    v30000.0 
b20221220T1200Z      V f+0    d+0    v30000.0 
b20221220T1200Z      T f+0    d+0    v30000.0 
b20221220T1200Z     RH f+0    d+0    v30000.0 
b20221220T1200Z      Z f+0    d+0    v30000.0 
b20221220T1200Z   VVPa f+0    d+0    v30000.0 
b20221220T1200Z      U f+0    d+0    v25000.0 
b20221220T1200Z      V f+0    d+0    v25000.0 
b20221220T1200Z      T f+0    d+0    v25000.0 
b20221220T1200Z      Z f+0    d+0    v25000.0 
b20221220T1200Z   rDIV f+0    d+0    v25000.0 
b20221220T1200Z      U f+0    d+0    v20000.0 
b20221220T1200Z      V f+0    d+0    v20000.0 
b20221220T1200Z      T f+0    d+0    v20000.0 
b20221220T1200Z      Z f+0    d+0    v20000.0 
b20221220T1200Z      U f+0    d+0    v15000.0 
b20221220T1200Z      V f+0    d+0    v15000.0 
b20221220T1200Z      T f+0    d+0    v15000.0 
b20221220T1200Z      Z f+0    d+0    v15000.0 
b20221220T1200Z      U f+0    d+0    v10000.0 
b20221220T1200Z      V f+0    d+0    v10000.0 
b20221220T1200Z      T f+0    d+0    v10000.0 
b20221220T1200Z      Z f+0    d+0    v10000.0 
b20221220T1200Z      U f+0    d+0    v7000.0  
b20221220T1200Z      V f+0    d+0    v7000.0  
b20221220T1200Z      T f+0    d+0    v7000.0  
b20221220T1200Z      Z f+0    d+0    v7000.0  
b20221220T1200Z      U f+0    d+0    v5000.0  
b20221220T1200Z      V f+0    d+0    v5000.0  
b20221220T1200Z      T f+0    d+0    v5000.0  
b20221220T1200Z      Z f+0    d+0    v5000.0  
b20221220T1200Z      U f+0    d+0    v3000.0  
b20221220T1200Z      V f+0    d+0    v3000.0  
b20221220T1200Z      T f+0    d+0    v3000.0  
b20221220T1200Z      Z f+0    d+0    v3000.0  
b20221220T1200Z      U f+0    d+0    v2000.0  
b20221220T1200Z      V f+0    d+0    v2000.0  
b20221220T1200Z      T f+0    d+0    v2000.0  
b20221220T1200Z      Z f+0    d+0    v2000.0  
b20221220T1200Z      U f+0    d+0    v1000.0  
b20221220T1200Z      V f+0    d+0    v1000.0  
b20221220T1200Z      T f+0    d+0    v1000.0  
b20221220T1200Z      Z f+0    d+0    v1000.0  
b20221220T1200Z      U f+360  d+0    v101214.5
b20221220T1200Z      V f+360  d+0    v101214.5
b20221220T1200Z      T f+360  d+0    v101302.5
b20221220T1200Z     RH f+360  d+0    v101302.5
b20221220T1200Z   Pmsl f+360  d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+360  v101325.0
b20221220T1200Z      U f+360  d+0    v100000.0
b20221220T1200Z      V f+360  d+0    v100000.0
b20221220T1200Z      T f+360  d+0    v100000.0
b20221220T1200Z     RH f+360  d+0    v100000.0
b20221220T1200Z      Z f+360  d+0    v100000.0
b20221220T1200Z      U f+360  d+0    v92500.0 
b20221220T1200Z      V f+360  d+0    v92500.0 
b20221220T1200Z      T f+360  d+0    v92500.0 
b20221220T1200Z     RH f+360  d+0    v92500.0 
b20221220T1200Z      Z f+360  d+0    v92500.0 
b20221220T1200Z      U f+360  d+0    v85000.0 
b20221220T1200Z      V f+360  d+0    v85000.0 
b20221220T1200Z      T f+360  d+0    v85000.0 
b20221220T1200Z     RH f+360  d+0    v85000.0 
b20221220T1200Z      Z f+360  d+0    v85000.0 
b20221220T1200Z      U f+360  d+0    v70000.0 
b20221220T1200Z      V f+360  d+0    v70000.0 
b20221220T1200Z      T f+360  d+0    v70000.0 
b20221220T1200Z     RH f+360  d+0    v70000.0 
b20221220T1200Z      Z f+360  d+0    v70000.0 
b20221220T1200Z   VVPa f+360  d+0    v70000.0 
b20221220T1200Z      U f+360  d+0    v60000.0 
b20221220T1200Z      V f+360  d+0    v60000.0 
b20221220T1200Z      T f+360  d+0    v60000.0 
b20221220T1200Z     RH f+360  d+0    v60000.0 
b20221220T1200Z      Z f+360  d+0    v60000.0 
b20221220T1200Z      U f+360  d+0    v50000.0 
b20221220T1200Z      V f+360  d+0    v50000.0 
b20221220T1200Z      T f+360  d+0    v50000.0 
b20221220T1200Z     RH f+360  d+0    v50000.0 
b20221220T1200Z      Z f+360  d+0    v50000.0 
b20221220T1200Z   rVOR f+360  d+0    v50000.0 
b20221220T1200Z      U f+360  d+0    v40000.0 
b20221220T1200Z      V f+360  d+0    v40000.0 
b20221220T1200Z      T f+360  d+0    v40000.0 
b20221220T1200Z     RH f+360  d+0    v40000.0 
b20221220T1200Z      Z f+360  d+0    v40000.0 
b20221220T1200Z      U f+360  d+0    v30000.0 
b20221220T1200Z      V f+360  d+0    v30000.0 
b20221220T1200Z      T f+360  d+0    v30000.0 
b20221220T1200Z     RH f+360  d+0    v30000.0 
b20221220T1200Z      Z f+360  d+0    v30000.0 
b20221220T1200Z   VVPa f+360  d+0    v30000.0 
b20221220T1200Z      U f+360  d+0    v25000.0 
b20221220T1200Z      V f+360  d+0    v25000.0 
b20221220T1200Z      T f+360  d+0    v25000.0 
b20221220T1200Z      Z f+360  d+0    v25000.0 
b20221220T1200Z   rDIV f+360  d+0    v25000.0 
b20221220T1200Z      U f+360  d+0    v20000.0 
b20221220T1200Z      V f+360  d+0    v20000.0 
b20221220T1200Z      T f+360  d+0    v20000.0 
b20221220T1200Z      Z f+360  d+0    v20000.0 
b20221220T1200Z      U f+360  d+0    v15000.0 
b20221220T1200Z      V f+360  d+0    v15000.0 
b20221220T1200Z      T f+360  d+0    v15000.0 
b20221220T1200Z      Z f+360  d+0    v15000.0 
b20221220T1200Z      U f+360  d+0    v10000.0 
b20221220T1200Z      V f+360  d+0    v10000.0 
b20221220T1200Z      T f+360  d+0    v10000.0 
b20221220T1200Z      Z f+360  d+0    v10000.0 
b20221220T1200Z      U f+360  d+0    v7000.0  
b20221220T1200Z      V f+360  d+0    v7000.0  
b20221220T1200Z      T f+360  d+0    v7000.0  
b20221220T1200Z      Z f+360  d+0    v7000.0  
b20221220T1200Z      U f+360  d+0    v5000.0  
b20221220T1200Z      V f+360  d+0    v5000.0  
b20221220T1200Z      T f+360  d+0    v5000.0  
b20221220T1200Z      Z f+360  d+0    v5000.0  
b20221220T1200Z      U f+360  d+0    v3000.0  
b20221220T1200Z      V f+360  d+0    v3000.0  
b20221220T1200Z      T f+360  d+0    v3000.0  
b20221220T1200Z      Z f+360  d+0    v3000.0  
b20221220T1200Z      U f+360  d+0    v2000.0  
b20221220T1200Z      V f+360  d+0    v2000.0  
b20221220T1200Z      T f+360  d+0    v2000.0  
b20221220T1200Z      Z f+360  d+0    v2000.0  
b20221220T1200Z      U f+360  d+0    v1000.0  
b20221220T1200Z      V f+360  d+0    v1000.0  
b20221220T1200Z      T f+360  d+0    v1000.0  
b20221220T1200Z      Z f+360  d+0    v1000.0  
b20221220T1200Z   Pmsl f+720  d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+720  v101325.0
b20221220T1200Z      Z f+720  d+0    v50000.0 
b20221220T1200Z   Pmsl f+1440 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+1440 v101325.0
b20221220T1200Z      Z f+1440 d+0    v50000.0 
b20221220T1200Z   Pmsl f+2160 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+2160 v101325.0
b20221220T1200Z      Z f+2160 d+0    v50000.0 
b20221220T1200Z   Pmsl f+2880 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+2880 v101325.0
b20221220T1200Z      Z f+2880 d+0    v50000.0 
b20221220T1200Z   Pmsl f+3600 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+3600 v101325.0
b20221220T1200Z      Z f+3600 d+0    v50000.0 
b20221220T1200Z   Pmsl f+4320 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+4320 v101325.0
b20221220T1200Z      Z f+4320 d+0    v50000.0 
b20221220T1200Z   Pmsl f+5040 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+5040 v101325.0
b20221220T1200Z      Z f+5040 d+0    v50000.0 
b20221220T1200Z   Pmsl f+5760 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+5760 v101325.0
b20221220T1200Z      Z f+5760 d+0    v50000.0 
b20221220T1200Z   Pmsl f+6480 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+6480 v101325.0
b20221220T1200Z      Z f+6480 d+0    v50000.0 
b20221220T1200Z   Pmsl f+7200 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+7200 v101325.0
b20221220T1200Z      Z f+7200 d+0    v50000.0 
b20221220T1200Z   Pmsl f+7920 d+0    v101324.0
b20221220T1200Z   RAIN f+0    d+7920 v101325.0
b20221220T1200Z      Z f+7920 d+0    v50000.0 
EOF

rm -f z.log
